
<div mat-dialog-title class="position-relative d-flex justify-content-center">
  <h2 class="mt-2">Witaj! ğŸ¤ </h2>
  <button mat-icon-button mat-dialog-close class="dialog-close-icon">
    <mat-icon>close</mat-icon>
  </button>
</div>
<mat-dialog-content class="mat-typography">
  <mat-button-toggle-group [(ngModel)]="authType" class="d-flex justify-content-center" name="authType">
    <mat-button-toggle value="LOGIN" class="w-50">Zaloguj siÄ™</mat-button-toggle>
    <mat-button-toggle value="REGISTER" class="w-50">DoÅ‚Ä…cz</mat-button-toggle>
  </mat-button-toggle-group>

  <div [ngSwitch]="authType">
    <form *ngSwitchCase="'LOGIN'" #loginForm="ngForm" class="d-flex flex-column mt-3">
      <mat-form-field>
        <input matInput placeholder="Nazwa uÅ¼ytkownika"
          [(ngModel)]="loginCredentials.username"
          name="usernameLogin" #usernameLogin="ngModel" required>
        <mat-error>ProszÄ™ podaÄ‡ nazwÄ™ uÅ¼ytkownika.</mat-error>
      </mat-form-field>
      <mat-form-field>
        <input matInput placeholder="HasÅ‚o"
          [(ngModel)]="loginCredentials.password"
          [type]="loginPasswordVisible ? 'text' : 'password'"
          class="password-input" name="passwordLogin" #passwordLogin="ngModel" required>
        <button *ngIf="loginCredentials.password"
          (click)="loginPasswordVisible = !loginPasswordVisible"
          mat-icon-button class="password-input-visibility" tabindex="-1">
          <mat-icon>{{ loginPasswordVisible ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        <mat-error>ProszÄ™ podaÄ‡ hasÅ‚o.</mat-error>
      </mat-form-field>

      <p class="forgot-password-label">Nie pamiÄ™tam hasÅ‚a..</p>

      <button mat-raised-button (click)="authenticate()" [disabled]="!loginForm.valid" color="accent">Zaloguj siÄ™</button>
    </form>
    <!-- TODO: Add 'forgotPassword' / 'resetPassword' functionality -->

    <form *ngSwitchCase="'REGISTER'" #registerForm="ngForm" class="d-flex flex-column mt-3">
      <mat-form-field>
        <input matInput placeholder="Nazwa uÅ¼ytkownika"
          [(ngModel)]="registerCredentials.username"
          name="usernameRegister" #usernameRegister="ngModel" required>
        <mat-error>ProszÄ™ podaÄ‡ nazwÄ™ uÅ¼ytkownika.</mat-error>
      </mat-form-field>
      <mat-form-field>
        <input matInput placeholder="HasÅ‚o"
          [(ngModel)]="registerCredentials.password"
          (ngModelChange)="onPasswordChange()"
          [type]="passwordVisible ? 'text' : 'password'"
          class="password-input" name="passwordRegister" #passwordRegister="ngModel" minlength="8" required>
          <button *ngIf="registerCredentials.password"
            (click)="passwordVisible = !passwordVisible"
            mat-icon-button class="password-input-visibility" tabindex="-1">
            <mat-icon>{{ passwordVisible ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
          <mat-error>
            <span *ngIf="passwordRegister.errors?.['required']">ProszÄ™ podaÄ‡ hasÅ‚o.</span>
            <span *ngIf="passwordRegister.errors?.['minlength']">HasÅ‚o zbyt krÃ³tkie.</span>
          </mat-error>
      </mat-form-field>
      <mat-form-field>
        <input matInput placeholder="PowtÃ³rz hasÅ‚o"
          [(ngModel)]="registerCredentials.confirmPassword"
          (ngModelChange)="onConfirmPasswordChange()"
          [type]="confirmPasswordVisible ? 'text' : 'password'"
          class="password-input" name="passwordRegisterConfirm" #passwordRegisterConfirm="ngModel" required>
        <button *ngIf="registerCredentials.confirmPassword"
          (click)="confirmPasswordVisible = !confirmPasswordVisible"
          mat-icon-button class="password-input-visibility" tabindex="-1">
          <mat-icon>{{ confirmPasswordVisible ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        <mat-error>
          <span *ngIf="passwordRegisterConfirm.errors?.['required']">ProszÄ™ podaÄ‡ hasÅ‚o.</span>
          <span *ngIf="passwordRegisterConfirm.errors?.['passwordMissmatch']">HasÅ‚a nie sÄ… takie same.</span>
        </mat-error>
      </mat-form-field>
      <mat-form-field>
        <input matInput placeholder="E-mail"
          [(ngModel)]="registerCredentials.email"
          (ngModelChange)="onEmailChange()" name="email" #email="ngModel" required>
        <mat-error>
          <span *ngIf="email.errors?.['required']">ProszÄ™ podaÄ‡ e-mail.</span>
          <span *ngIf="email.errors?.['invalidEmail']">Wprowadzane dane nie sÄ… e-mailem.</span>
        </mat-error>
      </mat-form-field>

      <ngx-recaptcha2 [(ngModel)]="reCaptcha" [siteKey]="captchaKey" [useGlobalDomain]="false" class="mt-2 mb-4" name="reCaptcha" required></ngx-recaptcha2>

      <button mat-raised-button (click)="register()" [disabled]="!registerForm.valid" color="accent">UtwÃ³rz konto</button>
    </form>
  </div>
</mat-dialog-content>
